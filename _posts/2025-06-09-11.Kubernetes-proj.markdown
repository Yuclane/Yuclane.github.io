---
layout: post
title:  "Kubernetes EKS í”„ë¡œì íŠ¸ êµ¬ì¶•"
date:   2025-06-09 18:44 +0900
categories: kubernetes proj 
---

EKSë¡œ ê¸°ë³¸ì ì¸ 3-Tier ì•„í‚¤í…ì²˜ êµ¬í˜„.

# Kubernetes EKS í”„ë¡œì íŠ¸ êµ¬ì¶•

## ëª©ì°¨
- [ê¸°ë³¸ ì•„í‚¤í…ì²˜](#ê¸°ë³¸-ì•„í‚¤í…ì²˜)
- [VPC êµ¬ì¶• ë° EKS ìƒì„±](#vpc-êµ¬ì¶•-ë°-eks-ìƒì„±)
- [EKS Pod ì„¤ì¹˜ ë° ì´ë¯¸ì§€ ë¹Œë“œ (ê¸°ë³¸ 3-Tier êµ¬ì¶•)](#eks-pod-ì„¤ì¹˜-ë°-ì´ë¯¸ì§€-ë¹Œë“œ-ê¸°ë³¸-3-tier-êµ¬ì¶•)
- [EKS ì¶”ê°€ ì„œë¹„ìŠ¤](#eks-ì¶”ê°€-ì„œë¹„ìŠ¤)

## ê¸°ë³¸ ì•„í‚¤í…ì²˜

![EKS ì•„í‚¤í…ì²˜](/assets/Images/11.Kubernetes-proj/EKS-ì•„í‚¤í…ì³ì˜_ë³µì‚¬ë³¸.drawio.png)

## VPC êµ¬ì¶• ë° EKS ìƒì„±

### 1. VPC ìƒì„±

![VPC ìƒì„± 1](/assets/Images/11.Kubernetes-proj/image.png)
![VPC ìƒì„± 2](/assets/Images/11.Kubernetes-proj/image%201.png)
![VPC ìƒì„± 3](/assets/Images/11.Kubernetes-proj/image%202.png)

### 2. EC2 - Bastion 1ëŒ€

![Bastion EC2 1](/assets/Images/11.Kubernetes-proj/image%203.png)
![Bastion EC2 2](/assets/Images/11.Kubernetes-proj/image%204.png)

### 3. EC2 - mgmt ec2 ìƒì„±

![mgmt EC2 1](/assets/Images/11.Kubernetes-proj/image%205.png)
![mgmt EC2 2](/assets/Images/11.Kubernetes-proj/image%206.png)

### 4. mobaXterm SSH ì—°ê²° (mgmt-ec2)

![SSH ì—°ê²°](/assets/Images/11.Kubernetes-proj/image%207.png)

### 5. ì—­í•  ìƒì„± (IAM)

#### a. EKS-WorkerNode-Role
IAM > ì—­í•  > ì—­í•  ë§Œë“¤ê¸° > EC2 > ì‚¬ìš© ì‚¬ë¡€ ì„ íƒ - EC2

![WorkerNode Role](/assets/Images/11.Kubernetes-proj/image%208.png)

#### b. EKS-ControlPlane-Role
IAM > ì—­í•  > ì—­í•  ë§Œë“¤ê¸° > EKS > ì‚¬ìš© ì‚¬ë¡€ ì„ íƒ - EKS Cluster

![ControlPlane Role](/assets/Images/11.Kubernetes-proj/image%209.png)

### 6. ì•¡ì„¸ìŠ¤ í‚¤ ìƒì„±

ìš°ì¸¡ ìœ„ ë³´ì•ˆ ìê²© ì¦ëª… - ì•¡ì„¸ìŠ¤ í‚¤ - CLI ëª…ë ¹ ìƒì„±

![ì•¡ì„¸ìŠ¤ í‚¤ 1](/assets/Images/11.Kubernetes-proj/image%2010.png)
![ì•¡ì„¸ìŠ¤ í‚¤ 2](/assets/Images/11.Kubernetes-proj/image%2011.png)

### 7. AWS Control Plane ì ‘ì†

#### a. timedatectl ì„¤ì •

```bash
sudo -i
timedatectl set-timezone Asia/Seoul
```

#### b. aws configure

```json
# aws configure
AWS Access Key ID [None]: [AWS Access Key ID]
AWS Secret Access Key [None]: [AWS Secret Access Key ID]
Default region name [None]: ap-northeast-2
Default output format [None]: json
```

#### c. eksctl ì„¤ì¹˜

```bash
curl --silent --location "https://github.com/weaveworks/eksctl/releases/latest/download/eksctl_$(uname -s)_amd64.tar.gz" | sudo tar xz -C /tmp
sudo mv /tmp/eksctl /usr/local/bin
eksctl version
```

#### d. kubectl ì„¤ì¹˜

```bash
curl -o kubectl https://amazon-eks.s3.us-west-2.amazonaws.com/1.17.9/2020-08-04/bin/linux/amd64/kubectl
sudo chmod +x ./kubectl
sudo mv ./kubectl /usr/local/bin
sudo kubectl version --short --client
```

#### e. í´ëŸ¬ìŠ¤í„° ìƒì„±ì„ ìœ„í•œ eks-cluster.yaml íŒŒì¼ ì‘ì„±

**âš ï¸ ë°‘ì¤„ ì¹œ ë¶€ë¶„ì€ ë³¸ì¸ì´ ë§Œë“  VPC-ID, cidr, ê³„ì • IDë¡œ ì„¤ì •í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.**

```yaml
apiVersion: eksctl.io/v1alpha5
kind: ClusterConfig

metadata:
  name: NRSON-EKS-CLUSTER
  region: ap-northeast-2
  
vpc:
  id: "vpc-0a9733dffd78d86d9"
  cidr: "10.0.0.0/16"
  subnets:
    private:
      ap-northeast-2a:
        id: "subnet-00120d56e8f9df873"
        cidr: "10.0.64.0/20"
      ap-northeast-2b:
        id: "subnet-00bb6d71569c85d2a"
        cidr: "10.0.80.0/20"
  nat:
    gateway: Disable
  clusterEndpoints:
    publicAccess: false
    privateAccess: true

iam:
  withOIDC: true
  serviceRoleARN: "arn:aws:iam::{user_id}:role/EKS-ControlPlane-Role"

managedNodeGroups:
  - name: EKS-NODE
    instanceType: m5.large
    minSize: 2
    desiredCapacity: 2
    maxSize: 4
    availabilityZones: ["ap-northeast-2a", "ap-northeast-2b"]
    volumeSize: 30
    privateNetworking: true
    ssh:
      allow: false
    labels: { role: worker }
    iam:
      instanceRoleARN: "arn:aws:iam::{user_id}:role/EKS-WORKERNODE-ROLE"
```

#### f. eksctl create

```bash
sudo eksctl create cluster -f eks-cluster.yaml
```

#### g. ë³´ì•ˆ ê·¸ë£¹ ë³€ê²½

**eksctl-NRSON-EKS-CLUSTER-cluster/ControlPlaneSecurityGroup**

**Inbound ê·œì¹™ ì¶”ê°€**

![ë³´ì•ˆ ê·¸ë£¹ ë³€ê²½](/assets/Images/11.Kubernetes-proj/image%2012.png)

#### h. ì™„ë£Œ í›„ kubectl alias ë“±ë¡

```bash
yum install bash-completion -y
source <(kubectl completion bash)
echo "source <(kubectl completion bash)" >> $HOME/.bashrc

alias k=kubectl
complete -o default -F __start_kubectl k
echo "alias k=kubectl" >> ~/.bashrc
echo "complete -o default -F __start_kubectl k" >> ~/.bashrc

source ./.bashrc
```

#### i. ë…¸ë“œ í™•ì¸

```bash
# k get nodes
NAME                                             STATUS   ROLES    AGE   VERSION
ip-10-0-67-204.ap-northeast-2.compute.internal   Ready    <none>   22m   v1.32.3-eks-473151a
ip-10-0-83-201.ap-northeast-2.compute.internal   Ready    <none>   22m   v1.32.3-eks-473151a
```

## EKS Pod ì„¤ì¹˜ ë° ì´ë¯¸ì§€ ë¹Œë“œ (ê¸°ë³¸ 3-Tier êµ¬ì¶•)

### DB ì„¤ì¹˜

#### 1. DB ë³´ì•ˆ ê·¸ë£¹ ìƒì„±

![DB ë³´ì•ˆ ê·¸ë£¹](/assets/Images/11.Kubernetes-proj/image%2013.png)

#### 2. DB ì„œë¸Œë„· ê·¸ë£¹ ìƒì„±

ìƒˆë¡œ Private Subnet ìƒì„±í•´ì„œ í•˜ê±°ë‚˜, ê¸°ì¡´ ì›Œì»¤ë…¸ë“œ ê·¸ë£¹ì— ìƒì„±

![DB ì„œë¸Œë„· ê·¸ë£¹](/assets/Images/11.Kubernetes-proj/image%2014.png)

#### 3. RDS ìƒì„± (MySQL)

![RDS ìƒì„±](/assets/Images/11.Kubernetes-proj/image%2015.png)

#### 4. DB í…œí”Œë¦¿, ê°€ìš© ì˜ì—­ ì„ íƒ

![DB í…œí”Œë¦¿](/assets/Images/11.Kubernetes-proj/image%2016.png)

#### 5. Database ë§ˆìŠ¤í„° ì‚¬ìš©ì ê³„ì •, ë¹„ë°€ë²ˆí˜¸ ì„¤ì •

![DB ê³„ì • ì„¤ì •](/assets/Images/11.Kubernetes-proj/image%2017.png)

#### 6. ì¸ìŠ¤í„´ìŠ¤ êµ¬ì„±

![ì¸ìŠ¤í„´ìŠ¤ êµ¬ì„±](/assets/Images/11.Kubernetes-proj/image%2018.png)

#### 7. ìŠ¤í† ë¦¬ì§€ ì„¤ì • (20 GB)

![ìŠ¤í† ë¦¬ì§€ ì„¤ì •](/assets/Images/11.Kubernetes-proj/image%2019.png)

#### 8. ì—°ê²° (Network)

![ë„¤íŠ¸ì›Œí¬ ì—°ê²° 1](/assets/Images/11.Kubernetes-proj/image%2020.png)
![ë„¤íŠ¸ì›Œí¬ ì—°ê²° 2](/assets/Images/11.Kubernetes-proj/image%2021.png)

#### 9. ì—”ë“œí¬ì¸íŠ¸, ë§ˆìŠ¤í„° ID, ë§ˆìŠ¤í„° íŒ¨ìŠ¤ì›Œë“œ ì €ì¥

**âš ï¸ ë³¸ì¸ RDS ì„¤ì •ìœ¼ë¡œ í•˜ì…”ì•¼ í•©ë‹ˆë‹¤**

- **ì—”ë“œí¬ì¸íŠ¸**: `doitmysql.cblfmzidovrx.ap-northeast-2.rds.amazonaws.com`
- **ë§ˆìŠ¤í„° ID**: `petclinicadmin`
- **ë§ˆìŠ¤í„° PW**: `Pa$$w0rd2025`

### Web ì„¤ì¹˜

#### 1. mod proxy ì„¤ì • íŒŒì¼ ìƒì„±

```bash
mkdir ~/httpd
cd ~/httpd
vi httpd.conf
```

```apache
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so

ServerName localhost

ProxyRequests Off
ProxyPreserveHost On

ProxyPass /petclinic/ http://was-svc.default.svc.cluster.local:8080/petclinic/
ProxyPassReverse /petclinic/ http://was-svc.default.svc.cluster.local:8080/petclinic/

RedirectMatch ^/$ /petclinic/
```

#### 2. Dockerfile ìƒì„±

```bash
vi Dockerfile
```

```dockerfile
FROM httpd:2.4

COPY ./httpd.conf /tmp/httpd_attach.conf

RUN cat /tmp/httpd_attach.conf >> /usr/local/apache2/conf/httpd.conf

EXPOSE 80
CMD ["httpd-foreground"]
```

#### 3. Docker Image ë¹Œë“œ

```bash
docker build -t petclinic-httpd .
```

#### 4. AWS ECR ë¦¬ì „, ê³„ì • ë¡œê·¸ì¸

**âš ï¸ ë°‘ì¤„ ì¹œ ë¶€ë¶„ ìê¸° IDë¡œ ë³€ê²½**

**âš ï¸ docker ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ í•  ê¶Œí•œì„ ê°€ì§„ userì—ì„œ login í•´ì•¼ í•©ë‹ˆë‹¤.**

```bash
aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com
```

#### 5. Docker ECR ë ˆí¬ì§€í† ë¦¬ ìƒì„±

```bash
aws ecr create-repository --repository-name petclinic-httpd
```

#### 6. Docker ì´ë¯¸ì§€ì˜ íƒœê·¸ë¥¼ ë³€ê²½

```bash
docker tag petclinic-httpd:latest {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com/petclinic-httpd:latest
```

#### 7. Docker ì´ë¯¸ì§€ë¥¼ ìì‹ ì˜ ECRì— push

```bash
docker push {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com/petclinic-httpd:latest
```

#### 8. Web yaml ìƒì„± í›„ ë°°í¬

**âš ï¸ ë°‘ì¤„ ì¹œ ë¶€ë¶„ì€ ìê¸° ECRì˜ URLë¡œ ìˆ˜ì •**

```bash
vi httpd.yaml
```

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      containers:
      - name: apache-web
        image: {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com/petclinic-httpd:latest
        ports:
        - containerPort: 80

---
apiVersion: v1
kind: Service
metadata:
  name: web-svc
spec:
  type: LoadBalancer
  selector:
    app: web
  ports:
  - port: 80
    targetPort: 80
```

```bash
k apply -f httpd.yaml
```

### WAS ì„¤ì¹˜

#### 1. JDK ì„¤ì¹˜

```bash
yum install java-11-amazon-corretto-devel -y
yum install maven -y

java --version
# openjdk 11.0.27 2025-04-15 LTS
# OpenJDK Runtime Environment Corretto-11.0.27.6.1 (build 11.0.27+6-LTS)
# OpenJDK 64-Bit Server VM Corretto-11.0.27.6.1 (build 11.0.27+6-LTS, mixed mode)
```

#### 2. Java í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
echo 'export JAVA_HOME=/usr/lib/jvm/java-11-amazon-corretto.x86_64/' >> ~/.bash_profile
echo 'export PATH=$JAVA_HOME/bin:$PATH' >> ~/.bash_profile
source ~/.bash_profile
```

#### 3. tar íŒŒì¼ ë‹¤ìš´ë¡œë“œ

```bash
mkdir ~/tomcat
cd ~/tomcat
git clone https://github.com/Yuclane/petclinic

tar -xvf ~/tomcat/petclinic_btc.tar
cd ~/tomcat/petclinic_btc
```

#### 4. pom.xml ìˆ˜ì •

```bash
vi pom.xml

# /mysql ì…ë ¥ í›„ Enterí‚¤ ì…ë ¥ ë‹¤ìŒìœ¼ë¡œ nì„ ëˆŒëŸ¬ í•´ë‹¹ ë¶€ë¶„ê¹Œì§€ ì´ë™ í›„ Enter
# Bold ì²˜ë¦¬ ëœ ë‚´ìš©ì„ ìì‹ ì˜ RDSì— ë§ê²Œ ìˆ˜ì •í•˜ê³  :wqë¡œ ì €ì¥ í›„ ì¢…ë£Œ
```

```xml
<profile>
    <id>MySQL</id>
        <activation>
        <activeByDefault>true</activeByDefault>
    </activation>
    <properties>
        <db.script>mysql</db.script>
        <jpa.database>MYSQL</jpa.database>
        <jdbc.driverClassName>com.mysql.cj.jdbc.Driver</jdbc.driverClassName>
        <jdbc.url>jdbc:mysql://doitmysql.cblfmzidovrx.ap-northeast-2.rds.amazonaws.com:3306/petclinic?useUnicode=true</jdbc.url>
        <jdbc.username>petclinicadmin</jdbc.username>
        <jdbc.password>Pa$$w0rd2025</jdbc.password>
    </properties>
    <dependencies>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>8.0.33</version>
            <scope>runtime</scope>
        </dependency>
    </dependencies>
```

#### 5. Maven ì†ŒìŠ¤ ë¹Œë“œ í›„ war íŒŒì¼ ì˜®ê¸°ê¸°

```bash
mvn clean install -P MySQL
# Build ì‹¤íŒ¨ ì‹œ í™•ì¸í•´ì•¼ í•  ì‚¬í•­:
# 1. RDSì˜ ì—”ë“œí¬ì¸íŠ¸, ë§ˆìŠ¤í„° ID, íŒ¨ìŠ¤ì›Œë“œ (mgmtì—ì„œ mysql client ì„¤ì¹˜ í›„ ì ‘ì† ì—¬ë¶€ í™•ì¸)
# 2. RDSì˜ ë³´ì•ˆ ê·¸ë£¹ì—ì„œ 3306 í¬íŠ¸ê°€ mgmt ec2, cluster(workerNode)ì˜ ë³´ì•ˆ ê·¸ë£¹ìœ¼ë¡œ ì—´ë ¤ìˆëŠ”ì§€

mv ~/tomcat/petclinic_btc/target/petclinic.war ~/tomcat
```

#### 6. Docker ì„¤ì¹˜

```bash
yum install docker -y
```

#### 7. Dockerfile ìƒì„±

```bash
cd ~/tomcat
vi dockerfile
```

```dockerfile
FROM tomcat:9.0.84-jdk11

COPY ./petclinic.war /usr/local/tomcat/webapps/

EXPOSE 8080

CMD ["catalina.sh", "run"]
```

#### 8. Docker image build

```bash
docker build -t petclinic-tomcat .

docker images
# REPOSITORY         TAG       IMAGE ID       CREATED          SIZE
# petclinic-tomcat   latest    39505590b9a0   24 minutes ago   498MB
```

#### 9. AWS ECR ë¦¬ì „, ê³„ì • ë¡œê·¸ì¸

**âš ï¸ ë°‘ì¤„ ì¹œ ë¶€ë¶„ ìê¸° IDë¡œ ë³€ê²½**

```bash
aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com
```

#### 10. ECR Repository ìƒì„±

```bash
aws ecr create-repository --repository-name petclinic-tomcat
```

#### 11. Docker ì´ë¯¸ì§€ì˜ íƒœê·¸ë¥¼ ë³€ê²½

```bash
docker tag petclinic-tomcat:latest {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com/petclinic-tomcat:latest
```

#### 12. Docker ì´ë¯¸ì§€ë¥¼ ìì‹ ì˜ ECRì— push

```bash
docker push {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com/petclinic-tomcat:latest
```

#### 13. Deployment ìƒì„± í›„ pod ë°°í¬

**âš ï¸ ë°‘ì¤„ ì¹œ ë¶€ë¶„ì€ ìê¸° ECRì˜ URLë¡œ ìˆ˜ì •**

```bash
vi tomcat.yaml
```

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: was
spec:
  replicas: 2
  selector:
    matchLabels:
      app: was
  template:
    metadata:
      labels:
        app: was
    spec:
      containers:
      - name: apache-was
        image: {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com/petclinic-tomcat:latest
        ports:
        - containerPort: 8080

---
apiVersion: v1
kind: Service
metadata:
  name: was-svc
spec:
  selector:
    app: was
  ports:
  - port: 8080
    targetPort: 8080
  type: ClusterIP
```

```bash
k apply -f tomcat.yaml
```

### AWS ALB ì»¨íŠ¸ë¡¤ëŸ¬ ì„¤ì¹˜ í›„ Ingress(ALB) ë°°í¬

#### 1. AWS ë¡œë“œ ë°¸ëŸ°ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ IAM ì •ì±… ë‹¤ìš´ë¡œë“œ

[ì°¸ê³  ë§í¬](https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/lbc-helm.html)

```bash
cd ~/httpd

curl -O https://raw.githubusercontent.com/kubernetes-sigs/aws-load-balancer-controller/v2.12.0/docs/install/iam_policy.json
```

#### 2. IAM ì •ì±… ìƒì„±

```bash
aws iam create-policy \
    --policy-name AWSLoadBalancerControllerIAMPolicy \
    --policy-document file://iam_policy.json
```

#### 3. ì„œë¹„ìŠ¤ ê³„ì • ìƒì„±

í˜„ì¬ ì‘ë™ì¤‘ì¸ EKSì˜ í´ëŸ¬ìŠ¤í„° ì´ë¦„, ë¦¬ì „ ì½”ë“œ ë° ê³„ì • IDì˜ ê°’ì„ ë°”ê¿‰ë‹ˆë‹¤.

```bash
eksctl create iamserviceaccount \
    --cluster=NRSON-EKS-CLUSTER \
    --namespace=kube-system \
    --name=aws-load-balancer-controller \
    --attach-policy-arn=arn:aws:iam::{user_id}:policy/AWSLoadBalancerControllerIAMPolicy \
    --override-existing-serviceaccounts \
    --region ap-northeast-2 \
    --approve
```

#### 4. Helm ì„¤ì¹˜

```bash
curl -fsSL https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash

# helm version í™•ì¸
helm version
```

#### 5. eks-charts ì°¨íŠ¸ Helm ë¦¬í¬ì§€í† ë¦¬ ì¶”ê°€

```bash
helm repo add eks https://aws.github.io/eks-charts
helm repo update eks
```

#### 6. helmì„ í†µí•´ aws-load-balancer-controller ì„¤ì¹˜

```bash
helm install aws-load-balancer-controller eks/aws-load-balancer-controller \
  -n kube-system \
  --set clusterName=NRSON-EKS-CLUSTER \
  --set serviceAccount.create=false \
  --set serviceAccount.name=aws-load-balancer-controller \
  --set region=ap-northeast-2
```

#### 7. CRD ì„¤ì¹˜

```bash
wget https://raw.githubusercontent.com/aws/eks-charts/master/stable/aws-load-balancer-controller/crds/crds.yaml
kubectl apply -f crds.yaml
```

#### 8. ì„¤ì¹˜ í™•ì¸

```bash
kubectl get deployment aws-load-balancer-controller

# NAME                           READY   UP-TO-DATE   AVAILABLE   AGE
# aws-load-balancer-controller   2/2     2            2           4m51s
```

#### 9. ê¸°ì¡´ web ë°°í¬ ì‚­ì œ í›„ yaml íŒŒì¼ ìˆ˜ì •

**âš ï¸ httpd.yaml íŒŒì¼ ìˆ˜ì • ì‹œ, public subnetì˜ idë¡œ ì§€ì •í•©ë‹ˆë‹¤.**

```bash
# yaml íŒŒì¼ì„ í†µí•´, ê¸°ì¡´ web ë°°í¬ ì œê±°
kubectl delete -f httpd.yaml

# yaml íŒŒì¼ ìˆ˜ì •
vi httpd.yaml
```

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      containers:
      - name: apache-web
        image: {user-id}.dkr.ecr.ap-northeast-2.amazonaws.com/petclinic-httpd:latest
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: web-svc
  labels:
    app: web
spec:
  type: NodePort
  selector:
    app: web
  ports:
    - port: 80
      targetPort: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: web-ingress
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP":80},{"HTTPS":443}]'
    alb.ingress.kubernetes.io/subnets: subnet-08abcb5f2f93ed4e1,subnet-0518bdb827ac408de
spec:
  rules:
    - http:
        paths:
          - path: /petclinic/
            pathType: Prefix
            backend:
              service:
                name: web-svc
                port:
                  number: 80
```

#### 10. ìˆ˜ì •í•œ httpd.yaml íŒŒì¼ ë°°í¬

```bash
kubectl apply -f httpd.yaml
```

### HTTPS ì„¤ì •

#### 1. Route53ì— ë„ë©”ì¸ ì¶”ê°€

Gabiaì—ì„œ êµ¬ë§¤í•œ ë„ë©”ì¸ì„ Route53ì— ì¶”ê°€í•©ë‹ˆë‹¤.

![Route53 ë„ë©”ì¸ 1](/assets/Images/11.Kubernetes-proj/image%2022.png)
![Route53 ë„ë©”ì¸ 2](/assets/Images/11.Kubernetes-proj/image%2023.png)
![Route53 ë„ë©”ì¸ 3](/assets/Images/11.Kubernetes-proj/image%2024.png)

#### 2. ë„¤ì„ì„œë²„ ì„¤ì •

Route53ì—ì„œ ìƒì„±ëœ ë ˆì½”ë“œë“¤ì˜ íŠ¸ë˜í”½ ë¼ìš°íŒ… ëŒ€ìƒì„ Gabiaì˜ ë„¤ì„ ì„œë²„ì— ì¶”ê°€í•©ë‹ˆë‹¤.

**âš ï¸ ë„¤ì„ì„œë²„ ë’¤ì— .ì„ ë¹¼ê³  ì¶”ê°€í•©ë‹ˆë‹¤.**

![ë„¤ì„ì„œë²„ ì„¤ì • 1](/assets/Images/11.Kubernetes-proj/image%2025.png)
![ë„¤ì„ì„œë²„ ì„¤ì • 2](/assets/Images/11.Kubernetes-proj/image%2026.png)
![ë„¤ì„ì„œë²„ ì„¤ì • 3](/assets/Images/11.Kubernetes-proj/image%2027.png)

#### 3. Certificate Managerì—ì„œ ì¸ì¦ì„œ ì¶”ê°€

Gabiaì—ì„œ êµ¬ë§¤í•œ ë„ë©”ì¸ì´ `psg-store.store`ë¼ë©´, ì•ì— `*`ì„ ë¶™ì—¬ ëª¨ë“  ë ˆì½”ë“œì— ì ìš©ì‹œí‚¬ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. (`*.psg-store.store`)

![ì¸ì¦ì„œ ì¶”ê°€ 1](/assets/Images/11.Kubernetes-proj/image%2028.png)
![ì¸ì¦ì„œ ì¶”ê°€ 2](/assets/Images/11.Kubernetes-proj/image%2029.png)

#### 4. ì¸ì¦ì„œë¥¼ Route53ì— CNAMEìœ¼ë¡œ ì¶”ê°€

![CNAME ì¶”ê°€ 1](/assets/Images/11.Kubernetes-proj/image%2030.png)
![CNAME ì¶”ê°€ 2](/assets/Images/11.Kubernetes-proj/image%2031.png)

#### 5. Route 53ì— CNAME ë ˆì½”ë“œ í™•ì¸

![CNAME ë ˆì½”ë“œ í™•ì¸](/assets/Images/11.Kubernetes-proj/image%2032.png)

#### 6. Certificate ARN ë³µì‚¬

ë¦¬ìŠ¤ë„ˆì— ì¸ì¦ì„œë¥¼ ì—°ê²°í•˜ê¸° ìœ„í•´, ë³¸ì¸ì˜ Certificate ARNì˜ ì •ë³´ë¥¼ ë³µì‚¬í•©ë‹ˆë‹¤.

![Certificate ARN](/assets/Images/11.Kubernetes-proj/image%2033.png)

#### 7. ALB yaml íŒŒì¼ì— SSL ì„¤ì • ì¶”ê°€

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      containers:
      - name: apache-web
        image: 701232040686.dkr.ecr.ap-northeast-2.amazonaws.com/petclinic-httpd:latest
        ports:
        - containerPort: 80
---
apiVersion: v1
kind: Service
metadata:
  name: web-svc
  labels:
    app: web
spec:
  type: NodePort
  selector:
    app: web
  ports:
    - port: 80
      targetPort: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: web-ingress
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP":80},{"HTTPS":443}]'
    alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:ap-northeast-2:{user_id}:certificate/{certificate-id}
    alb.ingress.kubernetes.io/ssl-redirect: '443'
    alb.ingress.kubernetes.io/subnets: subnet-08abcb5f2f93ed4e1,subnet-0518bdb827ac408de
spec:
  rules:
    - http:
        paths:
          - path: /petclinic/
            pathType: Prefix
            backend:
              service:
                name: web-svc
                port:
                  number: 80
```

#### 8. ì¸ì¦ì„œ ê²€ì¦ ì™„ë£Œ í™•ì¸

Apply í•˜ê¸° ì „ ì£¼ì˜ ì‚¬í•­

**âš ï¸ ë°˜ë“œì‹œ í•´ë‹¹ ìƒíƒœê°€ ê²€ì¦ ì™„ë£Œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.**

![ì¸ì¦ì„œ ê²€ì¦](/assets/Images/11.Kubernetes-proj/image%2034.png)

#### 9. Pod ë°°í¬

```bash
k apply -f httpd.yaml
```

#### 10. Route 53 ë ˆì½”ë“œ ìƒì„±

![Route 53 ë ˆì½”ë“œ](/assets/Images/11.Kubernetes-proj/image%2035.png)

## EKS ì¶”ê°€ ì„œë¹„ìŠ¤

### í”„ë¡œë©”í…Œìš°ìŠ¤ ì„¤ì¹˜

#### 1. í´ëŸ¬ìŠ¤í„°ì™€ IAM OIDC provider ì—°ê²°

```bash
eksctl utils associate-iam-oidc-provider --cluster=NRSON-EKS-CLUSTER --approve
```

#### 2. EBS AddOnì„ ìœ„í•œ ServiceAccount ìƒì„± ë° ê¶Œí•œ ë¶€ì—¬

```bash
eksctl create iamserviceaccount \
  --region ap-northeast-2 \
  --namespace kube-system \
  --cluster NRSON-EKS-CLUSTER \
  --name ebs-csi-controller-sa \
  --role-name EKS-Addon-EBS-Role \
  --attach-policy-arn arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy \
  --approve \
  --role-only
```

#### 3. EBS Addon ìƒì„±

ìœ„ì—ì„œ ìƒì„±ëœ IAM ê³„ì •ì˜ ARNìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

```bash
eksctl create addon \
--name aws-ebs-csi-driver \
--cluster NRSON-EKS-CLUSTER \
--service-account-role-arn arn:aws:iam::{user_id}:role/EKS-Addon-EBS-Role \
--force
```

#### 4. EBS-CSI-DRIVER í™•ì¸

```bash
eksctl get addon --name aws-ebs-csi-driver --cluster NRSON-EKS-CLUSTER
```

#### 5. ì‘ì—… ë””ë ‰í† ë¦¬ ìƒì„±

```bash
mkdir ~/prometheus
cd ~/prometheus
```

#### 6. Helm ì„¤ì¹˜ ì—¬ë¶€ì™€ ë²„ì „ í™•ì¸

3.xx ì´ìƒì´ë©´ ë©ë‹ˆë‹¤.

```bash
helm version
```

#### 7. Prometheus ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±

```bash
kubectl create ns monitoring
```

#### 8. Helmì— prometheus-community ì €ì¥ì†Œ ì¶”ê°€

```bash
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
```

#### 9. ì €ì¥ì†Œ ì¶”ê°€ í™•ì¸

```bash
helm repo list
```

#### 10. ì €ì¥ì†Œ ì—…ë°ì´íŠ¸

```bash
helm repo update prometheus-community
```

#### 11. Gitì„ í†µí•´ helm-chart ë°›ì•„ì˜¤ê¸°

helm install commandë¥¼ í†µí•´ ë°”ë¡œ ì„¤ì¹˜í•´ë„ ì¢‹ìŠµë‹ˆë‹¤. ì‹¤ì œ êµ¬ì„±ì´ ì–´ë–»ê²Œ ëëŠ”ì§€ ê¶ê¸ˆí•´ì„œ gitìœ¼ë¡œ helm-chartsë¡œ ë‹¤ìš´ë°›ê³  í•´ë´¤ìŠµë‹ˆë‹¤.

**âš ï¸ git command not foundë¼ë©´, git íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤ (AMI-Linux ê¸°ì¤€)**

```bash
git clone https://github.com/prometheus-community/helm-charts

yum install git-daemon.x86_64
```

#### 12. Prometheus values.yaml ìˆ˜ì •

Prometheusì˜ Podë“¤ì„ ê´€ë¦¬í•  Serviceë¥¼ NodePortë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
storageClassë¥¼ ì°¾ì•„ì„œ "gp2" or "gp3"ë¥¼ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.

```bash
vi ~/prometheus/helm-charts/charts/prometheus/values.yaml
```

![Prometheus values ìˆ˜ì • 1](/assets/Images/11.Kubernetes-proj/image%2036.png)
![Prometheus values ìˆ˜ì • 2](/assets/Images/11.Kubernetes-proj/image%2037.png)
![Prometheus values ìˆ˜ì • 3](/assets/Images/11.Kubernetes-proj/image%2038.png)

#### 13. Prometheus ì„¤ì¹˜

ì„œë¹„ìŠ¤ì˜ Typeì„ ë³€ê²½í–ˆë‹¤ë©´, Prometheusì˜ ì„¤ì¹˜ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.

```bash
helm install prometheus prometheus-community/prometheus -f ~/prometheus/helm-charts/charts/prometheus/values.yaml -n monitoring
```

#### 14. Helm ë°°í¬ í™•ì¸

statusê°€ deployedì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.

```bash
helm list
# NAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART                   APP VERSION
# prometheus      default         1               2025-05-28 17:32:45.273836232 +0900 KST deployed        prometheus-27.16.0      v3.4.0
```

#### 15. ë°°í¬í•œ ì„œë¹„ìŠ¤ë“¤ì˜ ìƒíƒœ í™•ì¸

```bash
k get all -n monitoring
```

```bash
NAME                                                     READY   STATUS    RESTARTS   AGE
pod/prometheus-alertmanager-0                            1/1     Running   0          2m
pod/prometheus-kube-state-metrics-66858d7dfd-bsvrl       1/1     Running   0          2m
pod/prometheus-prometheus-node-exporter-ch6s2            1/1     Running   0          2m
pod/prometheus-prometheus-node-exporter-w9vrz            1/1     Running   0          2m
pod/prometheus-prometheus-pushgateway-866c5c685c-w8bxr   1/1     Running   0          2m
pod/prometheus-server-7467554dc4-kl2tg                   2/2     Running   0          2m

NAME                                          TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
service/prometheus-alertmanager               ClusterIP   172.20.38.51     <none>        9093/TCP       2m1s
service/prometheus-alertmanager-headless      ClusterIP   None             <none>        9093/TCP       2m1s
service/prometheus-kube-state-metrics         ClusterIP   172.20.24.163    <none>        8080/TCP       2m1s
service/prometheus-prometheus-node-exporter   ClusterIP   172.20.110.164   <none>        9100/TCP       2m1s
service/prometheus-prometheus-pushgateway     ClusterIP   172.20.80.245    <none>        9091/TCP       2m1s
service/prometheus-server                     NodePort    172.20.83.66     <none>        80:31562/TCP   2m1s

NAME                                                 DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
daemonset.apps/prometheus-prometheus-node-exporter   2         2         2       2            2           kubernetes.io/os=linux   2m1s

NAME                                                READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/prometheus-kube-state-metrics       1/1     1            1           2m1s
deployment.apps/prometheus-prometheus-pushgateway   1/1     1            1           2m1s
deployment.apps/prometheus-server                   1/1     1            1           2m1s

NAME                                                           DESIRED   CURRENT   READY   AGE
replicaset.apps/prometheus-kube-state-metrics-66858d7dfd       1         1         1       2m1s
replicaset.apps/prometheus-prometheus-pushgateway-866c5c685c   1         1         1       2m1s
replicaset.apps/prometheus-server-7467554dc4                   1         1         1       2m1s

NAME                                       READY   AGE
statefulset.apps/prometheus-alertmanager   1/1     2m1s
```

#### 16. ALBë¥¼ Deploymentì— ë¶€ì°©í•  ALB ìƒì„±

```bash
vi prometheus-loadbalncer.yaml
```

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: ingress-monitoring
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: instance
    alb.ingress.kubernetes.io/load-balancer-name: prometheus-name
    alb.ingress.kubernetes.io/subnets: subnet-08abcb5f2f93ed4e1,subnet-0518bdb827ac408de
    alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:ap-northeast-2:{user_id}:certificate/{certificate-id}
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
spec:
  rules:
    - host:
      http:
        paths:
          - pathType: Prefix
            path: /
            backend:
              service:
                name: prometheus-server
                port:
                  number: 80
```

```bash
k apply -f prometheus-loadbalncer.yaml -n monitoring
```

#### 17. ALB DNS ì£¼ì†Œë¡œ ì ‘ì† í™•ì¸

ALBì˜ DNSì£¼ì†Œë¥¼ í†µí•´ ì¸í„°ë„·ì—ì„œ ì ‘ì†í•˜ì—¬, ì œëŒ€ë¡œ êµ¬ì¶•ëëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

```bash
k get ingress -n monitoring

# NAME                 CLASS    HOSTS   ADDRESS                                                       PORTS   AGE
# ingress-monitoring   <none>   *       prometheus-name-1852579681.ap-northeast-2.elb.amazonaws.com   80      5m58s
```

![Prometheus ì ‘ì† í™•ì¸](/assets/Images/11.Kubernetes-proj/image%2039.png)

### ê·¸ë¼íŒŒë‚˜ ì„¤ì¹˜ ë° í”„ë¡œë©”í…Œìš°ìŠ¤ ì—°ë™

#### 1. ê·¸ë¼íŒŒë‚˜ repo ì¶”ê°€

```bash
helm repo add grafana https://grafana.github.io/helm-charts
```

#### 2. ê·¸ë¼íŒŒë‚˜ helm ì„¤ì¹˜

```bash
helm install my-grafana grafana/grafana --namespace grafana --set service.type=NodePort --set persistence.enabled=true
```

#### 3. ê·¸ë¼íŒŒë‚˜ ì•„ì´ë””, íŒ¨ìŠ¤ì›Œë“œ ì–»ì–´ì˜¤ê¸°

**âš ï¸ ìœ„ ëª…ë ¹ì–´ì—ì„œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€ ì„œë¹„ìŠ¤ ì´ë¦„ì„ ë°”ê¿¨ë‹¤ë©´ ë§ì¶°ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.**

```bash
echo $(kubectl get secret my-grafana -n grafana -o jsonpath='{.data.admin-user}' | base64 --decode)
echo $(kubectl get secret my-grafana -n grafana -o jsonpath='{.data.admin-password}' | base64 --decode)
```

![ê·¸ë¼íŒŒë‚˜ ê³„ì • ì •ë³´](/assets/Images/11.Kubernetes-proj/image%2040.png)

#### 4. Load Balancer ìƒì„±

```bash
vi grafana-alb.yaml
```

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: garafana-ingress
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: instance
    alb.ingress.kubernetes.io/load-balancer-name: grafana-name
    alb.ingress.kubernetes.io/subnets: subnet-08abcb5f2f93ed4e1,subnet-0518bdb827ac408de
    alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:ap-northeast-2:{user_id}:certificate/{certificate-id}
    alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
spec:
  rules:
    - host:
      http:
        paths:
          - pathType: Prefix
            path: /
            backend:
              service:
                name: my-grafana
                port:
                  number: 80
```

```bash
k apply -f grafana-alb.yaml
```

#### 5. ê·¸ë¼íŒŒë‚˜ ì ‘ì†

Load Balancerì˜ DNS ì£¼ì†Œë¡œ ë“¤ì–´ê°‘ë‹ˆë‹¤. 3ë²ˆì—ì„œ ì–»ì–´ì˜¨ username, userpasswordë¥¼ ì…ë ¥í•´ì„œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.

![ê·¸ë¼íŒŒë‚˜ ë¡œê·¸ì¸ 1](/assets/Images/11.Kubernetes-proj/image%2041.png)
![ê·¸ë¼íŒŒë‚˜ ë¡œê·¸ì¸ 2](/assets/Images/11.Kubernetes-proj/image%2042.png)

#### 6. Prometheus ì—°ê²°

Prometheus ì„¤ì¹˜ í›„ grafanaì™€ ì—°ê²°í•©ë‹ˆë‹¤.
(SVCë¡œ ë¬¶ì–´ì§„ NodePortë¥¼ í™œìš©í•˜ì—¬ Prometheus ì„œë²„ì™€ ì—°ê²°í•˜ëŠ” ê²½ë¡œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.)

![Prometheus ì—°ê²° 1](/assets/Images/11.Kubernetes-proj/image%2043.png)
![Prometheus ì—°ê²° 2](/assets/Images/11.Kubernetes-proj/image%2044.png)

#### 7. Prometheus ì—°ê²° í™•ì¸

Prometheusê°€ Grafanaì— ì •ìƒì ìœ¼ë¡œ ì¶”ê°€ëëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

![Prometheus ì—°ê²° í™•ì¸](/assets/Images/11.Kubernetes-proj/image%2045.png)

#### 8. ë°ì´í„° í™•ì¸

DashBoardsì˜ ìƒ˜í”Œ Metricë“¤ì„ ë³´ê³  ì •ìƒì ìœ¼ë¡œ Dataë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

![ë°ì´í„° í™•ì¸](/assets/Images/11.Kubernetes-proj/image%2046.png)

#### 9. DashBoard Template ê°€ì ¸ì˜¤ê¸°

DashBoardì—ì„œ New - Importë¥¼ ëˆŒëŸ¬ì„œ, ê°„ë‹¨í•œ Templateì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

**ì°¸ê³  ë§í¬**: https://grafana.com/grafana/dashboards/

![Template ê°€ì ¸ì˜¤ê¸° 1](/assets/Images/11.Kubernetes-proj/image%2047.png)
![Template ê°€ì ¸ì˜¤ê¸° 2](/assets/Images/11.Kubernetes-proj/image%2048.png)

#### 10. DashBoard í™•ì¸

ìƒì„±ëœ DashBoardì—ì„œ Dataê°€ N/Aë¡œ í‘œì‹œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ì—¬ê¸°ì„œ í•´ë‹¹ ë¶€ë¶„ì„ ì¸ì§€í•´ì•¼ í•˜ëŠ”ë°ìš”.. Prometheusì˜ Templateì„ ë§Œë“¤ì—ˆì„ ë•Œì™€ ë‹¬ë¦¬ Query ë¶€ë¶„ì´ ë°”ë€ŒëŠ” ë“±ì˜ ì´ìœ ë¡œ N/Aë¡œ í‘œê¸°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Prometheus Version, Grafana Versionì´ í•´ë‹¹ Templateì˜ ë²„ì „ê³¼ ë¹„ìŠ·í•œì§€ í™•ì¸í•©ë‹ˆë‹¤.

![DashBoard í™•ì¸](/assets/Images/11.Kubernetes-proj/image%2049.png)

## ì£¼ìš” í•™ìŠµ í¬ì¸íŠ¸

### âœ… **ì•„í‚¤í…ì²˜ ì´í•´**
- EKS í´ëŸ¬ìŠ¤í„°ì˜ 3-Tier ì•„í‚¤í…ì²˜ êµ¬ì„±
- Private/Public ì„œë¸Œë„· ë¶„ë¦¬ë¥¼ í†µí•œ ë³´ì•ˆ ê°•í™”
- ALBë¥¼ í†µí•œ ì™¸ë¶€ íŠ¸ë˜í”½ ë¼ìš°íŒ…

### âœ… **ì»¨í…Œì´ë„ˆí™” ë° ë°°í¬**
- Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ECR ë ˆì§€ìŠ¤íŠ¸ë¦¬ í™œìš©
- Kubernetes Deployment, Service, Ingress ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
- Helmì„ í†µí•œ íŒ¨í‚¤ì§€ ê´€ë¦¬

### âœ… **ëª¨ë‹ˆí„°ë§ ë° ê´€ì°°ì„±**
- Prometheusë¥¼ í†µí•œ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- Grafanaë¥¼ í†µí•œ ë°ì´í„° ì‹œê°í™”
- í´ëŸ¬ìŠ¤í„° ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë‹ˆí„°ë§

### âœ… **ë³´ì•ˆ ì„¤ì •**
- IAM ì—­í•  ë° ì •ì±… ì„¤ì •
- SSL/TLS ì¸ì¦ì„œë¥¼ í†µí•œ HTTPS í†µì‹ 
- ë³´ì•ˆ ê·¸ë£¹ ë° ë„¤íŠ¸ì›Œí¬ ì •ì±…

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ

### ğŸ”§ **ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°**

1. **Build ì‹¤íŒ¨ ì‹œ í™•ì¸ ì‚¬í•­**
   - RDS ì—”ë“œí¬ì¸íŠ¸, ë§ˆìŠ¤í„° ID, íŒ¨ìŠ¤ì›Œë“œ í™•ì¸
   - RDS ë³´ì•ˆ ê·¸ë£¹ì—ì„œ 3306 í¬íŠ¸ ê°œë°© ì—¬ë¶€
   - mgmt ec2ì—ì„œ MySQL í´ë¼ì´ì–¸íŠ¸ë¡œ RDS ì ‘ì† í…ŒìŠ¤íŠ¸

2. **Pod ë°°í¬ ì‹¤íŒ¨ ì‹œ**
   - ECR ì´ë¯¸ì§€ ê²½ë¡œ í™•ì¸
   - IAM ê¶Œí•œ ì„¤ì • ê²€í† 
   - ë³´ì•ˆ ê·¸ë£¹ ë° ë„¤íŠ¸ì›Œí¬ ì„¤ì • ì ê²€

3. **ALB ìƒì„± ì‹¤íŒ¨ ì‹œ**
   - Public ì„œë¸Œë„· ID í™•ì¸
   - AWS Load Balancer Controller ì„¤ì¹˜ ìƒíƒœ í™•ì¸
   - Certificate ARN ë° ë„ë©”ì¸ ê²€ì¦ ìƒíƒœ í™•ì¸

## ì°¸ê³  ìë£Œ

- [AWS EKS ê³µì‹ ë¬¸ì„œ](https://docs.aws.amazon.com/eks/)
- [Kubernetes ê³µì‹ ë¬¸ì„œ](https://kubernetes.io/docs/)
- [Prometheus ê³µì‹ ë¬¸ì„œ](https://prometheus.io/docs/)
- [Grafana ê³µì‹ ë¬¸ì„œ](https://grafana.com/docs/)
- [AWS Load Balancer Controller](https://docs.aws.amazon.com/ko_kr/eks/latest/userguide/lbc-helm.html)

---

> **ğŸ’¡ íŒ**: ì´ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ Kubernetesì˜ í•µì‹¬ ê°œë…ê³¼ AWS í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì„œë¹„ìŠ¤ì˜ í†µí•© í™œìš©ë²•ì„ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê° ë‹¨ê³„ë³„ë¡œ ì°¨ê·¼ì°¨ê·¼ ì§„í–‰í•˜ë©°, ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¡œê·¸ë¥¼ ê¼¼ê¼¼íˆ í™•ì¸í•˜ëŠ” ìŠµê´€ì„ ê¸°ë¥´ì„¸ìš”.